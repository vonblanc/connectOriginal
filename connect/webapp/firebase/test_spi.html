<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

   <script src="https://apis.google.com/js/client.js"></script>
   

    
   <script>

	 var fireToken;
     var apiRoot="http://localhost:8080/_ah/api";
     var request={
  		   "Message":"Hello it's me",
  		   
     }

	 function init(token)
	 {
	 	postinit(apiRoot,token);
	 	
	 }
 
    
    	
    	 
    	           
    	      
    	      
    	      var postinit=  function(apiRoot,token) {
    	    	  
    	    	  console.log("got into the initialize function......");
    	    	  // Loads the OAuth and helloworld APIs asynchronously, and triggers login
    	    	  // when they have completed.
    	    	  var apisToLoad;
    	    	  var callback = function() {
    	    	    if (--apisToLoad == 0) {
    	    	    	
    	    	    	console.log("STARTING AJAX BABY!!!!!.............")
    	    	        call(token);
    	    	    }
    	    	  }

    	    	  apisToLoad = 1; // must match number of calls to gapi.client.load()
    	    	  gapi.client.load('connectapi', 'v1', callback, apiRoot);
    	    	};

    	      
               
    	    	
    	    	
    	    	


    	  // Loads the OAuth and helloworld APIs asynchronously, and triggers login
    	  // when they have completed.
    	  
    	  

    	  var call = function(token) {
            	   
            	   


                   $.ajax({

                       url: 'http://localhost:8080/_ah/api/connectapi/v1/test',

                       type: 'GET',

                       dataType: 'json',

                       data: request,

                       success: function (data, textStatus, xhr) {

                           console.log(data);

                       },
                       
                       headers:{
                    	   'Authorization': 'Bearer '+token
                    	   
                    	   
                       },

                       error: function (xhr, textStatus, errorThrown) {
                           
                    	   
                           console.log('Error in Operation');
                           console.log(textStatus + "Error thrown:"+ errorThrown);
                           
                       }

                   });
            	   
            	   
            	   
            	   /*
    	        console.log("currently about exectuing the gapi request func");
    	        
    	        gapi.client.connectapi.decMessage(request).execute(function(response){
    	        	
    	        	
    	        	console.log(response);
    	        	
    	        });
                    */
    	   
    	    /*    
    	        gapi.client.request({

    	    	 

    	    	  
    	       'path':'/connectapi/v1/test',
    	        'method':'GET',
    	        'params': {'Message':'hello its me'},
    	        'headers': {

    	        'Authorization': 'Bearer '+ fireToken,

    	        },
    	    }).then(function(reponse){

    	          console.log(JSON.stringify(reponse));



    	        }, function(error){console.log(error);
    	        
    	        console.log(error.headers);
    	        });
    	    */

    	  }

</script>








</head>

<body>

  <div id="buttext_cont">
    <div id="input_holder">
      Put token inside:
      <input id="get_token" type="text" >

    </div>
    <button id="trans_token"></button>
    

  </div>


<script type="text/javascript">


    $("#trans_token").click(function(){

var value=$("#get_token").val();
fireToken=value;
console.log(fireToken);

init(fireToken);



  

 
});





</script>



</body>




</html>